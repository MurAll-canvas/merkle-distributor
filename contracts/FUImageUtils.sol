// SPDX-License-Identifier: GPL-3.0-or-later
pragma solidity =0.8.17;

import {Base64} from "@openzeppelin/contracts/utils/Base64.sol";
import {Strings} from "@openzeppelin/contracts/utils/Strings.sol";

/// @title StakingSVG
/// @notice Provides a function for generating an SVG associated with a Staking NFT position
library FUImageUtils {
    using Strings for uint256;

    function generateBase64SVG(
        uint256 animationDurationSeconds,
        string memory message
    ) internal pure returns (string memory svg) {
        return
            string(
                abi.encodePacked(
                    "data:image/svg+xml;base64,",
                    Base64.encode(bytes(generateSVG(animationDurationSeconds, message)))
                )
            );
    }

    function generateBase64Html(
        uint256 animationDurationSeconds,
        string memory message
    ) internal pure returns (string memory html) {
        return
            string(
                abi.encodePacked(
                    "data:text/html;base64,",
                    Base64.encode(
                        bytes(
                            abi.encodePacked(
                                "<html><head><style>",
                                "html, body {width: 100vw;height: 100vh;margin: 0;display: flex;align-items: center;justify-content: center;overflow: hidden;background-color: #2d2d2d;}",
                                "svg {max-width: 100%;max-height: 100%;}",
                                "</style></head><body>",
                                generateSVG(animationDurationSeconds, message),
                                "</body></html>"
                            )
                        )
                    )
                )
            );
    }

    function generateSVG(
        uint256 animationDurationSeconds,
        string memory message
    ) internal pure returns (string memory svg) {
        return
            string(
                abi.encodePacked(
                    '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" id="Layer_1" x="0" y="0" style="enable-background:new 0 0 230.93 186.7" version="1.1" viewBox="0 0 230.93 186.7"><defs><style>@import url("https://fonts.googleapis.com/css?family=Permanent+Marker");</style></defs><defs><linearGradient id="greyToBlackGradient" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#2d2d2d;stop-opacity:1" /><stop offset="70%" style="stop-color:#1d1d1d;stop-opacity:1" /><stop offset="100%" style="stop-color:black;stop-opacity:1"/></linearGradient><path id="SVGID_1_" d="m203.31 121.83-77.72-9.25 68.36-9.07-15.23-1.8 12.7-1.66-77.72-9.25 68.36-9.07-19.48-2.3-3.21-24.22c-.28-.02-.55-.07-.81-.17-6.27-2.46-24.88-4.09-45.26-3.96-20.38.13-38.97 1.98-45.21 4.52-.26.11-.53.17-.81.18L64.56 78.4l32.65 3.85-68.11 9.06 77.47 9.25-12.7 1.66 15.23 1.8L41 113.1l77.47 9.25-60.12 7.84-3.5 29.11c5.04-1.91 14.11-3.16 21.12-3.89 10.95-1.14 24.08-1.78 37.97-1.87 13.89-.09 27.03.4 37.99 1.4 7.02.64 16.11 1.78 21.16 3.63l-4.28-32.25 34.5-4.49z"/><path id="reuse-0" d="M35.59 80.47c-1.75 0-3.37.06-3.99.78-.33.39-.83 1.5-.4 4.56.23 1.62 2.51 1.96 4.39 1.96s4.17-.34 4.4-1.96c.43-3.06-.07-4.17-.4-4.56-.62-.72-2.25-.78-4-.78z" class="st0"/></defs><defs><symbol id="eye"><path d="M95.01 111.6c-11.55.07-21.01-9.27-21.08-20.82-.04-6.08 2.7-9.05 8.37-9.08 1.63-.01 3.45.19 5.38.4 2.29.25 4.65.51 7.16.5 2.5-.02 4.86-.3 7.15-.58 1.92-.23 3.74-.46 5.37-.47 5.67-.03 8.45 2.9 8.48 8.98.06 11.55-9.28 21-20.83 21.07z" class="st2"/><path d="M107.36 83.75c3.82-.02 6.23 1.25 6.27 6.79.06 10.35-8.28 18.8-18.63 18.86-10.35.06-18.8-8.28-18.86-18.63-.03-5.54 2.36-6.84 6.18-6.87 3.32-.02 7.72.93 12.53.9 4.81-.03 9.19-1.03 12.51-1.05m-.02-4.41.03 4.41-.03-4.41c-1.76.01-3.64.24-5.62.48-2.22.27-4.52.55-6.9.57-2.38.01-4.68-.24-6.9-.48-1.99-.22-3.87-.42-5.63-.41-1.2.01-4.87.03-7.55 2.58-2.05 1.95-3.04 4.81-3.01 8.72.08 12.77 10.53 23.09 23.3 23.01 12.77-.08 23.09-10.53 23.01-23.3-.02-3.91-1.04-6.75-3.12-8.68-2.71-2.52-6.38-2.5-7.58-2.49z"/><ellipse cx="94.9" cy="93.06" rx="9.49" ry="11.21" transform="matrix(1 -.00614 .00614 1 -.57 .585)"/><circle cx="96.94" cy="89.52" r="3.4" class="st2"/></symbol><symbol id="leftEyebrow"><path d="m74.97 62.85 27.79-7.92c2.78-.79 5.67.82 6.46 3.59a5.229 5.229 0 0 1-4.66 6.65l-28.83 2.02c-1.22.09-2.28-.83-2.36-2.05-.08-1.07.61-2.01 1.6-2.29z"/></symbol><symbol id="leftHand"><path d="M69.92 121.41c-.35-2.16-.7-4.38-.7-5.53 0-6.02-4.11-10.23-9.99-10.23-.26 0-.52.02-.78.04-2.14-4.25-6.16-5.84-9.61-5.84-.27 0-.54.01-.83.03l.28-18.34c0-6.9-4.92-11.51-12.23-11.51-4.13 0-8.18 1.58-10.82 4.23-2.13 2.14-3.25 4.82-3.24 7.77v.28l1.83 18.5c-.33-.02-.67-.02-1.02-.02-6.02 0-10.91 4.54-10.94 10.13-.05 2.04-.08 4.11-.08 6.16-.39.5-.79.96-1.21 1.43-1.16 1.31-2.48 2.78-3.2 5.18-1.26 3.84.65 7.93 5.67 12.18.37 1.94.82 3.45 1.37 4.59 1.71 3.55 6.08 4.78 9.71 5.46 1.04.19 2.82 1.35 4.26 2.28 2.56 1.66 5.19 3.36 8.13 3.36 3.09 0 5.53-1.25 7.31-2.17 1.24-.64 2.31-1.19 3.23-1.19 7.71 0 10.94-3.18 13.07-5.28.91-.9 1.37-1.33 1.89-1.48 2.11-.58 7.73-2.12 8.74-8.74.48-3.07-.19-7.25-.84-11.29z"/><use xlink:href="#reuse-0" class="st0"/><path d="M64.41 114.38c-.22-4.28-6.27-4.94-8.01-1.86l-.88 12.8-2.09 2.41s1.11-13.29 1.2-17.63c.13-5.91-8.28-6.12-9.19-2.51l-2.29 17.12-1.15 2.55 1.58-46.01c0-7.3-15.32-7.39-15.28.35l3.16 42.79-1.43 2.81-2.44-18.9c-.82-2.7-9.07-3.48-9.8 2.23-.75 5.93-.31 19.85 1.89 24.45.94 1.95 4.86 2.79 6.67 3.13 3.88.73 8.36 5.57 11.6 5.57 4.09 0 6.61-3.36 10.54-3.36 9.43 0 9.46-5.4 13.83-6.61 1.08-.3 2.67-1.03 3.04-1.84 1-2.19.26-6.42-.3-9.87-.39-2.48-.57-6.03-.65-7.62zM41.82 86.06c-.19 1.33-1.25 3.55-6.23 3.55-4.73 0-5.99-1.93-6.22-3.55-.41-2.92-.14-4.89.83-6.02 1.13-1.32 3.11-1.42 5.39-1.42s4.26.11 5.4 1.42c.97 1.13 1.24 3.1.83 6.02z" class="st0"/><path d="M35.59 78.62c-2.28 0-4.26.11-5.39 1.42-.97 1.13-1.24 3.1-.83 6.02.23 1.62 1.49 3.55 6.22 3.55 4.98 0 6.04-2.23 6.23-3.55.41-2.92.14-4.89-.83-6.02-1.13-1.32-3.12-1.42-5.4-1.42zm4.4 7.18c-.23 1.62-2.52 1.96-4.4 1.96-1.88 0-4.16-.34-4.39-1.96-.43-3.06.07-4.17.4-4.56.62-.72 2.24-.78 3.99-.78s3.38.06 4 .78c.33.39.83 1.5.4 4.56z"/><use xlink:href="#reuse-0" style="opacity:.4;fill:#fff"/></symbol><style>@keyframes handMoveUpDown{0%,to{transform:translateY(0)}50%{transform:translateY(-5px)}}@keyframes rightHandMoveUpDown{0%,to{transform:scale(-1,1) translate(-230.93px,0)}50%{transform:scale(-1,1) translate(-230.93px,5px)}} .marquee-text {display: inline-block;font-family: "Permanent Marker", Arial, Helvetica, sans-serif;font-size: 46.675px;font-weight: bold;color: #1CD3CF;transform-origin: center left;white-space: nowrap;will-change: transform;overflow: visible;-webkit-animation: marquee ',
                    animationDurationSeconds.toString(),
                    "s linear infinite;animation: marquee ",
                    animationDurationSeconds.toString(),
                    's linear infinite;}.marquee-text::before {content: attr(data-text);position: absolute;top: 0;left: 0;z-index: -1;overflow: visible;color: black;-webkit-text-stroke: 12.75px black; text-stroke: 12.75px black; } @keyframes marquee{0%{transform:translateX(100%)}to{transform:translateX(-100%)}}.st0{fill:#e91bfa}.st2{fill:#fff}.st3{fill:#999}.leftHandAnimation{animation:handMoveUpDown 2s infinite}</style><use xlink:href="#SVGID_1_"/></defs><rect width="100%" height="100%" fill="url(#greyToBlackGradient)"/><path d="m204.04 115.04-23.67-2.82 14.41-1.91c2.97-.39 5.5-2.57 6.04-5.52.49-2.71-.63-5.32-2.75-6.83a6.87 6.87 0 0 0-5.68-4.67l-23.9-2.84 14.4-1.91c3.08-.41 5.66-2.75 6.09-5.83.54-3.86-2.21-7.3-5.95-7.74l-14.22-1.68-2.1-15.84a8.515 8.515 0 0 0 1.44-5.97l-.11-.82c-.38-2.86-2.16-5.36-4.77-6.58-.87-.4-1.88-.78-3.08-1.14-2.89-3.95-7.12-7.37-12.57-10.17-5.13-2.64-11.04-4.6-17.59-5.83l-.08-12.26c-.02-2.57-1.19-7.09-8.85-8.45-2.09-.37-4.77-.57-7.55-.57h-.36c-2.92.02-5.72.26-7.9.67-7.65 1.45-8.76 5.98-8.75 8.55l.08 12.26c-6.53 1.31-12.42 3.34-17.52 6.05-5.42 2.87-9.6 6.34-12.45 10.33-1.12.35-2.07.72-2.9 1.1-2.71 1.27-4.52 3.91-4.88 6.88l-.08.66a8.57 8.57 0 0 0 1.51 5.96L57.95 77.6c-.12 1.03-.02 2.04.31 2.99L28.6 84.54c-3.08.41-5.65 2.74-6.09 5.82-.54 3.86 2.21 7.3 5.94 7.74l38.86 4.64-26.82 3.57c-3.08.41-5.66 2.74-6.09 5.82-.54 3.86 2.21 7.3 5.94 7.74l23.28 2.78-6.01.78c-3.09.4-5.52 2.85-5.89 5.95l-2.32 19.34c-.46 3.8-1.64 7.44-3.11 10.97-.4.97-.66 2.01-.74 3.06l-.1 1.29c-.03.41-.02.83.02 1.24l.01.08c.17 1.61.8 3.16 1.82 4.49.09.12.19.23.29.35 2.11 4.32 7.42 5.83 9.45 6.4 3.41.97 8.13 1.8 14.03 2.49 10.79 1.26 25.03 1.95 40.1 1.95 1.03 0 2.06 0 3.1-.01 16.26-.1 31.59-.98 43.17-2.47 5.89-.76 10.6-1.65 14-2.66 2.02-.6 7.31-2.17 9.37-6.52a8.876 8.876 0 0 0 2.04-4.85l.01-.09c.04-.41.04-.83 0-1.24l-.11-1.29a9.916 9.916 0 0 0-.77-3.05c-1.51-3.51-2.75-7.14-3.25-10.93l-2.09-15.72 27.73-3.62a6.84 6.84 0 0 0 5.86-7.81c-.49-3.07-3.1-5.38-6.19-5.74z"/><use xlink:href="#SVGID_1_" class="st0"/><clipPath id="clipShimmer"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path d="m144.53 54.83 2.92 97.76c7.44-.04 15.19 1.72 15.19 1.72l-11-98.53c-4.46-.91-7.11-.95-7.11-.95z" class="st2" style="opacity:.6;clip-path:url(#clipShimmer)"/><path d="m103.26 26.53-.07-11.68c-.01-.83.98-1.39 3.2-1.81 1.79-.34 4.16-.53 6.67-.55 2.52-.02 4.89.15 6.68.47 2.22.39 3.22.94 3.22 1.77l.07 11.68-19.77.12z" class="st3"/><path d="M113.07 13.08c5.13-.03 9.29.71 9.3 1.65l.07 11.08-18.58.11-.07-11.08c-.01-.94 4.15-1.72 9.28-1.76m-.01-1.19c-2.55.02-4.96.21-6.78.56-1.83.35-3.7.9-3.69 2.4l.07 11.08.01 1.2 1.2-.01 18.58-.11 1.2-.01-.01-1.2-.07-11.08c-.01-1.5-1.88-2.03-3.72-2.36-1.83-.32-4.24-.49-6.79-.47z"/><ellipse cx="113.15" cy="27.11" class="st3" rx="9.89" ry="2.47" transform="matrix(1 -.00614 .00614 1 -.164 .695)"/><path d="M113.14 25.24c5.13-.03 9.29.78 9.3 1.81.01 1.03-4.15 1.89-9.28 1.93-5.13.03-9.29-.78-9.3-1.81 0-1.04 4.15-1.9 9.28-1.93m-.01-1.2c-2.56.02-4.97.23-6.8.61-1.71.36-3.68.96-3.67 2.52.01 1.55 1.98 2.14 3.7 2.47 1.83.36 4.25.54 6.81.53 2.56-.02 4.97-.23 6.8-.61 1.71-.36 3.68-.96 3.67-2.52-.01-1.55-1.98-2.14-3.7-2.47-1.83-.35-4.25-.54-6.81-.53z"/><circle cx="113.26" cy="18.83" r="2.84" class="st2"/><path d="M113.25 16.59a2.245 2.245 0 1 1-2.23 2.26c-.01-1.24.99-2.26 2.23-2.26m-.01-1.2c-1.9.01-3.43 1.57-3.42 3.46.01 1.9 1.57 3.43 3.46 3.42s3.43-1.57 3.42-3.46-1.56-3.43-3.46-3.42z"/><path d="m106.17 35.16-.04-6.79c-.01-1.76 5.37-1.93 7.02-1.94s7.04.09 7.05 1.85l.04 6.79-14.07.09z" class="st3"/><path d="M113.15 27.03c3.55-.02 6.44.54 6.44 1.26l.04 6.19-12.87.08-.04-6.19c0-.72 2.88-1.32 6.43-1.34m-.01-1.19c-1.8.01-3.5.16-4.78.43-.85.18-2.84.59-2.83 2.11l.04 6.19.01 1.2 1.2-.01 12.87-.08 1.2-.01-.01-1.2-.04-6.19c-.01-1.52-2.01-1.9-2.86-2.07-1.3-.25-3-.39-4.8-.37z"/><path d="M113.26 44.93c17.49-.11 33.07 1.01 41.86 2.88-2.19-3.37-5.85-6.43-10.79-8.97-8.35-4.29-19.41-6.62-31.15-6.55s-22.77 2.53-31.06 6.93c-4.91 2.6-8.53 5.71-10.68 9.11 8.77-1.99 24.33-3.29 41.82-3.4z" style="fill:#ccc"/><path d="M159.53 54.34c-.22 0-.43-.04-.64-.12-6.47-2.54-24.79-4.15-45.59-4.03-20.8.13-39.11 1.97-45.54 4.59-.2.08-.42.13-.64.13-.49 0-.96-.21-1.29-.58a1.71 1.71 0 0 1-.42-1.35l.1-.82c.07-.59.44-1.11.98-1.35 6.1-2.84 24.9-4.84 46.8-4.97 21.89-.13 40.72 1.63 46.85 4.4.53.24.91.75.99 1.34l.11.82c.07.49-.08.99-.41 1.36-.34.36-.81.58-1.3.58z" class="st3"/><path d="M113.27 46.73c22.05-.14 40.66 1.7 46.48 4.32.26.12.43.36.47.64l.11.82a.83.83 0 0 1-.81.94c-.1 0-.2-.02-.31-.06-6.37-2.5-24.53-4.22-45.93-4.09s-39.53 2.07-45.87 4.65a.83.83 0 0 1-1.13-.87l.1-.82c.03-.28.21-.53.46-.65 5.79-2.69 24.38-4.75 46.43-4.88m-.01-1.8c-22.01.14-40.97 2.17-47.17 5.06-.82.38-1.38 1.15-1.49 2.06l-.1.82c-.09.75.15 1.5.65 2.06s-.74 1.65.01 1.64c.33 0 2.62-.83 2.93-.96 6.24-2.54 24.83-4.39 45.21-4.52 20.38-.13 38.99 1.5 45.26 3.96.31.12 2.76 1.11 3.1 1.1.75 0-.66-1.26-.17-1.82.49-.57.72-1.32.62-2.07l-.11-.81c-.12-.91-.69-1.67-1.51-2.04-6.24-2.81-25.22-4.61-47.23-4.48z"/><path d="M72.29 48.14c6.03-8.79 22.05-15.13 40.9-15.25 18.85-.12 34.95 6.04 41.08 14.75.58.12 1.14.23 1.67.36-2.21-3.65-6.05-6.97-11.34-9.69-8.43-4.34-19.59-6.69-31.42-6.61-11.83.07-22.96 2.56-31.34 7-5.25 2.78-9.05 6.14-11.22 9.83.53-.14 1.09-.27 1.67-.39z"/><path d="M175.78 162.51c-.1-1.14-.81-2.14-1.86-2.62-7.38-3.37-32.05-5.61-59.99-5.43-27.94.17-52.57 2.71-59.92 6.17-1.04.49-1.74 1.5-1.83 2.64l-.1 1.29.01.08c.04.37.19.72.45 1.05.5-2.08 3.36-3.19 5.89-3.94 3.09-.92 7.49-1.75 13.07-2.47 11.34-1.46 26.42-2.32 42.45-2.42s31.11.58 42.47 1.9c5.59.65 9.99 1.43 13.1 2.31 2.53.72 5.41 1.8 5.93 3.87.25-.34.4-.69.43-1.06l.01-.08-.11-1.29z" class="st3"/><path d="M114.06 174.21c-15.99.1-31.04-.57-42.36-1.89-5.54-.64-9.9-1.41-12.96-2.28-3.7-1.05-5.36-2.18-5.36-3.68-.01-1.5 1.63-2.65 5.32-3.75 3.05-.9 7.4-1.72 12.93-2.44 11.31-1.46 26.34-2.31 42.34-2.41 15.99-.1 31.04.57 42.36 1.89 5.54.64 9.9 1.41 12.96 2.28 3.7 1.05 5.36 2.18 5.36 3.68.01 1.5-1.63 2.65-5.32 3.75-3.05.9-7.4 1.72-12.93 2.44-11.32 1.45-26.35 2.31-42.34 2.41z" class="st3"/><path d="m176.78 163.64-.03-.34-.08-.87a4.1 4.1 0 0 0-2.38-3.36c-4.69-2.14-14.76-3.42-22.37-4.12-10.96-1-24.1-1.48-37.99-1.4s-27.02.73-37.97 1.87c-7.61.79-17.65 2.19-22.32 4.39a4.11 4.11 0 0 0-2.34 3.39l-.07.87-.03.34-.01.16.02.16c.02 3.95 4.72 5.44 7.28 6.16 3.11.88 7.51 1.66 13.1 2.31 11.36 1.32 26.45 2 42.47 1.9s31.1-.96 42.45-2.42c5.58-.72 9.97-1.55 13.07-2.47 2.55-.76 7.23-2.3 7.2-6.25l.02-.16-.02-.16zm-62.73 9.67c-32.99.2-59.76-2.91-59.78-6.96-.02-4.05 26.7-7.49 59.69-7.69 32.99-.2 59.76 2.91 59.78 6.96.03 4.05-26.7 7.49-59.69 7.69zm60.92-9.38c-1.05-1.43-3.36-2.27-5.45-2.86-3.11-.88-7.51-1.66-13.1-2.31-11.36-1.32-26.45-2-42.47-1.9s-31.1.96-42.45 2.42c-5.58.72-9.97 1.55-13.07 2.47-2.08.62-4.38 1.48-5.41 2.92l-.03-.13.03-.34.07-.87c.06-.82.57-1.55 1.31-1.9 7.08-3.34 31.05-5.91 59.54-6.09s52.49 2.1 59.61 5.35a2.29 2.29 0 0 1 1.34 1.88l.08.87.03.34c-.01.06-.02.1-.03.15z"/><use xlink:href="#eye"/><use xlink:href="#eye" transform="translate(42)"/><use xlink:href="#leftEyebrow" class="leftHandAnimation"/><use xlink:href="#leftEyebrow" transform="matrix(-1 0 0 1 230 7)"/><use xlink:href="#leftHand" class="leftHandAnimation"/><use xlink:href="#leftHand" style="animation:rightHandMoveUpDown 2s infinite"/><path id="mouth" d="m97.79 131.2 36.7-3.22c2.87-.25 5.4 1.87 5.65 4.74s-1.87 5.4-4.74 5.65c-.28.02-.58.02-.85.01l-36.73-2.77a2.208 2.208 0 0 1-2.04-2.37c.09-1.1.95-1.95 2.01-2.04z"/><foreignObject width="100%" height="100%" x="0" y="75"><div xmlns="http://www.w3.org/1999/xhtml" style="width:230.93px;padding-top:15px;margin:0;overflow:visible;white-space:nowrap;position:relative"><div data-text="',
                    message,
                    '" class="marquee-text">',
                    message,
                    "</div></div></foreignObject></svg>"
                )
            );
    }
}
/* solhint-enable */
